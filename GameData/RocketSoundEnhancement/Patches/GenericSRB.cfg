//https://forum.kerbalspaceprogram.com/index.php?/topic/179579-wip110x-rocket-sound-enhancement-v053-unmuted/page/13/&tab=comments#comment-3916632
@PART[*]:HAS[@MODULE[ModuleEngines*]:HAS[@PROPELLANT[SolidFuel]],!MODULE[RSE_Engines],!MODULE[ProceduralPart]]:AFTER[RocketSoundEnhancement]
{
	!sound_vent_medium = engage
	!sound_rocket_hard = running
	!sound_vent_soft = disengage
	!sound_explosion_low = flameout
	!sound_rocket_mini = running
	
	@EFFECTS{@running_closed{!AUDIO{}}}
	@EFFECTS{@engage{!AUDIO{}}}
	@EFFECTS{@flameout{!AUDIO{}}}
	
	__tmp_soundfile = #$/MODULE[ModuleEngines*]/maxThrust$
	@__tmp_soundfile ^= :^[0-9]$:SRB_Light:            // for thrust 0-9 use light soundfile
	@__tmp_soundfile ^= :^[1-9][0-9]$:SRB_Light:       // for thrust 10-99 use light soundfile
	@__tmp_soundfile ^= :^[1-9][0-9][0-9]$:SRB_Medium: // for thrust 100-999 use medium soundfile
	@__tmp_soundfile ^= :^[^S].*$:SRB_Heavy:           // for remaining thrusts use heavy soundfile
	
	__tmp_volume = #$/MODULE[ModuleEngines*]/maxThrust$
	@__tmp_volume ^= :^[0-9]$:_0.5:            // for thrust 0-9 use volume 0.5
	@__tmp_volume ^= :^[1-9][0-9]$:_1.0:       // for thrust 10-99 use volume 1.0
	@__tmp_volume ^= :^[1-2][0-9][0-9]$:_0.6:  // for thrust 100-299 use volume 0.6
	@__tmp_volume ^= :^[3-5][0-9][0-9]$:_0.8:  // for thrust 300-599 use volume 0.8
	@__tmp_volume ^= :^[6-9][0-9][0-9]$:_1.0:  // for thrust 600-999 use volume 1.0
	@__tmp_volume ^= :^1[0-9][0-9][0-9]$:_0.8: // for thrust 1000-1999 use volume 0.8
	@__tmp_volume ^= :^2[0-9][0-9][0-9]$:_1.0: // for thrust 2000-2999 use volume 1.0
	@__tmp_volume ^= :^[^_].*$:_1.5:           // for remaining thrusts use volume 1.5
	@__tmp_volume ^= :_::
	
	__tmp_pitch = #$/MODULE[ModuleEngines*]/maxThrust$
	@__tmp_pitch ^= :^[0-9]$:_1.2:            // for thrust 0-9 use pitch 1.2
	@__tmp_pitch ^= :^[1-9][0-9]$:_1.0:       // for thrust 10-99 use pitch 1.0
	@__tmp_pitch ^= :^[1-2][0-9][0-9]$:_1.5:  // for thrust 100-299 use pitch 1.5
	@__tmp_pitch ^= :^[3-5][0-9][0-9]$:_1.2:  // for thrust 300-599 use pitch 1.2
	@__tmp_pitch ^= :^[6-9][0-9][0-9]$:_1.0:  // for thrust 600-999 use pitch 1.0
	@__tmp_pitch ^= :^1[0-9][0-9][0-9]$:_1.5: // for thrust 1000-1999 use pitch 1.5
	@__tmp_pitch ^= :^2[0-9][0-9][0-9]$:_1.0: // for thrust 2000-2999 use pitch 1.0
	@__tmp_pitch ^= :^[^_].*$:_0.8:           // for remaining thrusts use pitch 0.8
	@__tmp_pitch ^= :_::
	
	__tmp_spread = #$/MODULE[ModuleEngines*]/maxThrust$
	@__tmp_spread ^= :^[0-9]$:_0.12:           // for thrust 0-9 use spread 0.12
	@__tmp_spread ^= :^[1-9][0-9]$:_0.25:      // for thrust 10-99 use spread 0.25
	@__tmp_spread ^= :^[1-3][0-9][0-9]$:_0.25: // for thrust 100-399 use spread 0.25
	@__tmp_spread ^= :^[^_].*$:_0.5:           // for remaining thrusts use spread 0.5
	@__tmp_spread ^= :_::
	
	MODULE
	{
		name = RSE_Engines
		volume = #$../__tmp_volume$
		
		Engine
		{
			SOUNDLAYER
			{
				name = ThrustHigh
				audioClip = #$../../../__tmp_soundfile$
				@audioClip ^= :^.*$:RocketSoundEnhancement/Sounds/Engines/$0-High
				loop = true
				spread = #$../../../__tmp_spread$
				channel = ShipBoth
				
				volume = 0.0 0.0
				volume = 0.33 0.0
				volume = 0.66 1.0
				volume = 1.0 1.0
				
				pitch = #$../../../__tmp_pitch$
			}
			
			SOUNDLAYER
			{
				name = ThrustLow
				audioClip = #$../../../__tmp_soundfile$
				@audioClip ^= :^.*$:RocketSoundEnhancement/Sounds/Engines/$0-Low
				loop = true
				spread = #$../../../__tmp_spread$
				channel = ShipBoth
				
				volume = 0.0 0.0
				volume = 0.33 1.0
				volume = 0.66 0.0
				volume = 1.0 0.0
				
				pitch = #$../../../__tmp_pitch$
			}
		}
		Flameout
		{
			SOUNDLAYER
			{
				name = FlameOut
				audioClip = sound_explosion_low
				
				channel = ShipBoth
				
				volume = 1.0
				pitch = #$../../../__tmp_pitch$
				@pitch *= 1.5
			}
		}
	}
}
